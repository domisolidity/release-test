(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[168],{97516:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var r=n(50029),o=n(16835),a=n(87794),i=n.n(a),c=n(67294),u=function(){return Array.from(Array(20),(function(){return new Array(12).fill([0,"clear"])}))},s=function(e,t,n){for(var r=n.x,o=n.y,a=0;a<e.tetromino.length;a++)for(var i=0;i<e.tetromino[a].length;i++)if(0!==e.tetromino[a][i]&&(!t[a+e.pos.y+o]||!t[a+e.pos.y+o][i+e.pos.x+r]||"clear"!==t[a+e.pos.y+o][i+e.pos.x+r][1]))return!0};var f=n(59499),l={0:{shape:[[0]],color:"0, 0, 0"},I:{shape:[[0,"I",0,0],[0,"I",0,0],[0,"I",0,0],[0,"I",0,0]],color:"80, 227, 230"},J:{shape:[[0,"J",0],[0,"J",0],["J","J",0]],color:"36, 95, 223"},L:{shape:[[0,"L",0],[0,"L",0],[0,"L","L"]],color:"223, 173, 36"},O:{shape:[["O","O"],["O","O"]],color:"223, 217, 36"},S:{shape:[[0,"S","S"],["S","S",0],[0,0,0]],color:"48, 211, 56"},T:{shape:[[0,0,0],["T","T","T"],[0,"T",0]],color:"132, 61, 198"},Z:{shape:[["Z","Z",0],[0,"Z","Z"],[0,0,0]],color:"227, 78, 78"}},d=function(){var e="IJLOSTZ",t=e[Math.floor(Math.random()*e.length)];return l[t]};function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e,t){var n=(0,c.useState)(u()),r=n[0],o=n[1],a=(0,c.useState)(0),i=a[0],s=a[1];return(0,c.useEffect)((function(){s(0);var n=function(n){var r=n.map((function(e){return e.map((function(e){return"clear"===e[1]?[0,"clear"]:e}))}));return e.tetromino.forEach((function(t,n){t.forEach((function(t,o){0!==t&&(r[n+e.pos.y][o+e.pos.x]=[t,"".concat(e.collided?"merged":"clear")])}))})),e.collided?(t(),function(e){return e.reduce((function(t,n){return-1===n.findIndex((function(e){return 0===e[0]}))?(s((function(e){return e+1})),t.unshift(new Array(e[0].length).fill([0,"clear"])),t):(t.push(n),t)}),[])}(r)):r};o((function(e){return n(e)}))}),[e,t]),[r,o,i]},h=n(45697),m=n.n(h),b=n(53918),y=b.ZP.div.withConfig({displayName:"StyledCell",componentId:"sc-11gump-0"})(["width:auto;background:rgba(",",0.8);border:",";border-bottom-color:rgba(",",0.1);border-right-color:rgba(",",1);border-top-color:rgba(",",1);border-left-color:rgba(",",0.3);"],(function(e){return e.color}),(function(e){return 0===e.type?"0px solid":"4px solid"}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color})),v=n(85893),w=function(e){var t=e.type;return(0,v.jsx)(y,{type:t,color:l[t].color})},k=c.memo(w);w.prototype={type:m().number};var S=b.ZP.div.withConfig({displayName:"StyledStage",componentId:"sc-imdmlc-0"})(["display:grid;grid-template-rows:repeat(",",calc(25vw / ","));grid-template-columns:repeat(",",1fr);grid-gap:1px;border:2px solid #333;width:100%;max-width:25vw;background:#111;position:relative;"],(function(e){return e.height}),(function(e){return e.width}),(function(e){return e.width})),O=b.ZP.div.withConfig({displayName:"StyledDisplay",componentId:"sc-1qyfq3z-0"})(["box-sizing:border-box;display:flex;justify-content:",";position:",";top:",";align-items:center;margin:0 0 20px 0;padding:20px;border:4px solid #333;min-height:30px;width:100%;border-radius:20px;color:",";background:#000;font-family:Pixel,Arial,Helvetica,sans-serif;font-size:",";"],(function(e){return e.gameOver?"center":""}),(function(e){return e.gameOver?"absolute":""}),(function(e){return e.gameOver?"20%":""}),(function(e){return e.gameOver?"red":"#999"}),(function(e){return e.gameOver?"2rem":"0.8rem"})),Z=function(e){var t=e.gameOver,n=e.text;return(0,v.jsx)(O,{gameOver:t,children:n})},j=function(e){var t=e.stage,n=e.gameOver;return(0,v.jsxs)(S,{width:t[0].length,height:t.length,children:[n?(0,v.jsx)(Z,{gameOver:n,text:"Game Over"}):null,t.map((function(e){return e.map((function(e,t){return(0,v.jsx)(k,{type:e[0]},t)}))}))]})},A=b.ZP.div.withConfig({displayName:"StyledStartButton",componentId:"sc-1rhe1zq-0"})(["box-sizing:border-box;margin:0 0 20px 0;min-height:30px;width:100%;height:60px;border-radius:20px;border:none;color:white;background:#333;font-family:Pixel,Arial,Helvetica,sans-serif;font-size:1rem;outline:none;button{width:100%;height:100%;}button:disabled{opacity:0.3;cursor:not-allowed;}"]),C=function(e){var t=e.callback,n=e.isPlaying;return(0,v.jsx)(A,{children:(0,v.jsx)("button",{disabled:n,onClick:t,children:"Start Game"})})},P=b.ZP.div.withConfig({displayName:"StyledTetris__StyledTetrisWrapper",componentId:"sc-fwywfn-0"})(["width:100%;height:100%;background:url(",") #000;background-size:cover;overflow:hidden;cursor:default;"],{src:"/_next/static/media/bg.d900898b.png",height:1590,width:1920,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAIAAAC6O5sJAAAAZUlEQVR42iWMAQ4DQQgCUek16f9f2+tC2T2NiQGGut4fw1VdQPVoLVsAmKso3TC6q2qOZW4pRixO/vu+OxzEGT5V2BMC8M4xvbA2d7wTz4o9L1unnBVkfS2FJHnJOhCln40e2voD8dAycz15mmMAAAAASUVORK5CYII="}),E=b.ZP.div.withConfig({displayName:"StyledTetris",componentId:"sc-fwywfn-1"})(["display:flex;align-items:flex-start;padding:40px;margin:0 auto;max-width:900px;aside{width:100%;max-width:200px;display:block;padding:0 20px;}.mission-box{margin:10px;padding:10px;background-color:lawngreen;border-radius:10px;color:purple;}"]),I=n(76988),T=n(25617),N=n(82531),M=n(58006),_=n(453),L=n(68527),D=n(53238),J=n(20076),z=function(){var e=(0,T.v9)((function(e){return e.blockchain})),t=e.account,n=e.auth,a=I.Z.gameList[1].gameTitle,f=(0,c.useState)(null),p=f[0],h=f[1],m=(0,c.useState)(!1),b=m[0],y=m[1],w=function(){var e=(0,c.useState)({pos:{x:0,y:0},tetromino:l[0].shape,collided:!1}),t=e[0],n=e[1],r=function(e,t){var n=e.map((function(t,n){return e.map((function(e){return e[n]}))}));return t>0?n.map((function(e){return e.reverse()})):n.reverse()},o=(0,c.useCallback)((function(){n({pos:{x:4,y:0},tetromino:d().shape,collided:!1})}),[]);return[t,function(e){var t=e.x,r=e.y,o=e.collided;n((function(e){return x(x({},e),{},{pos:{x:e.pos.x+=t,y:e.pos.y+=r},collided:o})}))},o,function(e,o){var a=JSON.parse(JSON.stringify(t));a.tetromino=r(a.tetromino,o);for(var i=a.pos.x,c=1;s(a,e,{x:0,y:0});)if(a.pos.x+=c,(c=-(c+(c>0?1:-1)))>a.tetromino[0].length)return r(a.tetromino,-o),void(a.pos.x=i);n(a)}]}(),k=(0,o.Z)(w,4),S=k[0],O=k[1],A=k[2],J=k[3],z=g(S,A),B=(0,o.Z)(z,3),V=B[0],G=B[1],R=function(e){var t=(0,c.useState)(0),n=t[0],r=t[1],o=(0,c.useState)(0),a=o[0],i=o[1],u=(0,c.useState)(0),s=u[0],f=u[1],l=[40,100,300,1200],d=(0,c.useCallback)((function(){e<=0||(r((function(t){return t+l[e-1]*(s+1)})),i((function(t){return t+e})))}),[s,l,e]);return(0,c.useEffect)((function(){d()}),[d,e,n]),[n,r,a,i,s,f]}(B[2]),U=(0,o.Z)(R,6),Q=U[0],q=U[1],K=U[2],F=U[3],H=U[4],W=U[5],X=(0,c.useState)(""),Y=X[0],$=X[1],ee=(0,c.useState)(""),te=ee[0],ne=ee[1],re=(0,c.useState)(""),oe=re[0],ae=re[1],ie=(0,c.useState)(""),ce=ie[0],ue=ie[1],se=(0,c.useState)(0),fe=se[0],le=se[1],de=(0,c.useState)(""),pe=de[0],xe=de[1],ge=(0,c.useState)(!1),he=ge[0],me=ge[1],be=(0,c.useState)(""),ye=be[0],ve=be[1],we=(0,c.useState)(""),ke=we[0],Se=we[1],Oe=(0,c.useState)(""),Ze=Oe[0],je=Oe[1];function Ae(e){37!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&40!=e.keyCode||e.preventDefault()}(0,c.useEffect)((function(){fe&&(xe(Q),ue(Q))}),[fe]),(0,c.useEffect)((function(){fe&&(xe(pe+(Q-ce)*parseFloat(fe)),ue(Q))}),[Q]),(0,c.useEffect)((0,r.Z)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,I.Z.getMyNFT(t);case 4:r=e.sent,je(r);case 6:case"end":return e.stop()}}),e)}))),[t,n]),(0,c.useEffect)((0,r.Z)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n&&a&&Ze){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,I.Z.setParticipant(t,a);case 4:return e.next=6,I.Z.initChance(t,a,Ze);case 6:return e.t0=$,e.next=9,I.Z.getMyChance(t,a);case 9:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=ne,e.next=14,I.Z.getGameItems();case 14:return e.t3=e.sent,(0,e.t2)(e.t3),e.t4=ve,e.next=19,I.Z.getMyBestScore(t,a);case 19:return e.t5=e.sent,(0,e.t4)(e.t5),e.next=23,I.Z.getMission(t,a);case 23:(r=e.sent)&&Se(r),window.addEventListener("keydown",Ae);case 26:case"end":return e.stop()}}),e)}))),[Ze]);var Ce=function(e){$(e)},Pe=function(){var e=(0,r.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.resultBonus&&ae(t.resultBonus),t.extraPoints&&le(t.extraPoints);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(e){s(S,V,{x:e,y:0})||O({x:e,y:0})},Ie=function(){var e=(0,r.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Y<=0)){e.next=3;break}return alert("\uc794\uc5ec \uac8c\uc784 \uae30\ud68c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc544\uc774\ud15c\uc744 \uad6c\uc785\ud558\uc154\uc11c \ucda9\uc804\ud558\uc138\uc694 ^\u3148^"),e.abrupt("return");case 3:if(window.confirm("\ud69f\uc218\uac00 \ucc28\uac10\ub429\ub2c8\ub2e4. \uac8c\uc784\uc744 \uc2dc\uc791\ud558\uc2dc\uaca0\uc74d\ub2c8\uae4c?")){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,I.Z.minusGameCount(t,a);case 7:if(e.sent.data){e.next=11;break}return alert("\uac8c\uc784 \ud69f\uc218\uc5d0 \ubb38\uc81c \uc788\uc74c"),e.abrupt("return");case 11:return e.next=13,I.Z.getMyChance(t,a);case 13:n=e.sent,$(n),me(!0),ae(""),le(""),xe(""),G(u()),h(1e3),A(),y(!1),q(0),F(0),W(0);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=(0,r.Z)(i().mark((function e(){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K>10*(H+1)&&(W((function(e){return e+1})),h(1e3/(H+1)+100)),!s(S,V,{x:0,y:1})){e.next=31;break}if(!(S.pos.y<1)){e.next=28;break}if(y(!0),h(null),!pe){e.next=10;break}return e.next=8,I.Z.sendScore(t,a,pe,oe);case 8:e.next=12;break;case 10:return e.next=12,I.Z.sendScore(t,a,Q,oe);case 12:if(!ke){e.next=23;break}if(console.log("\ubbf8\uc158\uc788\uc74c"),!ke.attainment){e.next=16;break}return e.abrupt("return");case 16:if(!(K>=ke.DailyMission.targetValue)){e.next=23;break}return e.next=19,I.Z.updateMission(t,ke.mission_id);case 19:return e.next=21,I.Z.getMission(t,a);case 21:n=e.sent,Se(n);case 23:return e.next=25,I.Z.getMyBestScore(t,a);case 25:r=e.sent,ve(r),me(!1);case 28:O({x:0,y:0,collided:!0}),e.next=32;break;case 31:O({x:0,y:1,collided:!1});case 32:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ne=function(e){var t=e.keyCode;if(!b){if(fe)switch(t){case 37:t=39;break;case 39:t=37;break;case 38:t=40;break;case 40:t=38}37===t?Ee(-1):39===t?Ee(1):40===t?(h(null),Te()):38===t&&J(V,-1)}};return function(e,t){var n=(0,c.useRef)();(0,c.useEffect)((function(){n.current=e}),[e]),(0,c.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){Te()}),p),(0,v.jsxs)(L.kC,{mt:"120px",children:[(0,v.jsx)(D.Z,{filledValue:Q,hasMission:ke}),t&&n?(0,v.jsxs)(L.xu,{w:"100%",children:[(0,v.jsx)(M.Z,{}),(0,v.jsx)(P,{role:"button",tabIndex:"0",onKeyDown:function(e){return Ne(e)},onKeyUp:function(e){var t=e.keyCode;b||(fe?38===t&&h(1e3/(H+1)+100):40===t&&h(1e3/(H+1)+100))},children:(0,v.jsxs)(E,{children:[(0,v.jsx)(j,{stage:V,gameOver:b}),(0,v.jsxs)("aside",{children:[(0,v.jsxs)("div",{children:[(0,v.jsx)(Z,{text:"Chance: ".concat(Y)}),(0,v.jsx)(Z,{text:"Best score: ".concat(ye)}),pe&&oe?(0,v.jsx)(Z,{text:"Score: ".concat(pe," x").concat(oe)}):pe?(0,v.jsx)(Z,{text:"Score: ".concat(pe)}):oe?(0,v.jsx)(Z,{text:"Score: ".concat(Q," x").concat(oe)}):(0,v.jsx)(Z,{text:"Score: ".concat(Q)}),(0,v.jsx)(Z,{text:"Rows: ".concat(K)}),(0,v.jsx)(Z,{text:"Level: ".concat(H)})]}),(0,v.jsx)(C,{callback:Ie,isPlaying:he})]}),(0,v.jsx)("div",{children:te&&te.map((function(e){return(0,v.jsx)(N.Z,{item:e,gameTitle:a,getItemEffect:Pe,resultBonus:oe,extraPoints:fe,isPlaying:he,updateChance:Ce},e.itemId)}))})]})})]}):(0,v.jsx)(_.Z,{receivedText:"\ub85c\uadf8\uc778 \ubc0f \ub300\ud45c NFT\ub97c \uc124\uc815\ud558\uc154\uc57c \uac8c\uc784\uc5d0 \ucc38\uc5ec\ud558\uc2e4 \uc218 \uc788\uc74d\ub2c8\ub2e4"})]})},B=z;z.getLayout=function(e){return(0,v.jsx)(J.Z,{children:e})}},6242:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/tetris",function(){return n(97516)}])}},function(e){e.O(0,[482,714,354,173,874,597,988,755,379,698,774,888,179],(function(){return t=6242,e(e.s=t);var t}));var t=e.O();_N_E=t}]);